{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container my-5" style="max-width: 600px;">
  <h2 class="text-center mb-4">Book Your Session</h2>
  <form id="bookingForm" method="post" action="{% url 'book_facility' %}">
    {% csrf_token %}
    <!-- Basic fields -->
    <div class="mb-3">
      <label for="id_name" class="form-label">Name</label>
      <input type="text" class="form-control" id="id_name" name="name" placeholder="Your Name" required>
    </div>
    <div class="mb-3">
      <label for="id_facility_type" class="form-label">Facility Type</label>
      <select class="form-select" id="id_facility_type" name="facility_type" required>
        <option value="">Select a facility</option>
        <option value="gym">Gym</option>
        <option value="pool">Pool</option>
      </select>
    </div>
    <div class="mb-3">
      <label for="id_location" class="form-label">Location</label>
      <select class="form-select" id="id_location" name="location" required>
        <option value="">Select a location</option>
        <option value="north">North Branch</option>
        <option value="south">South Branch</option>
        <option value="east">East Branch</option>
        <option value="west">West Branch</option>
      </select>
    </div>
    <div class="mb-3">
      <label for="id_additional_info" class="form-label">Additional Info</label>
      <textarea class="form-control" id="id_additional_info" name="additional_info" rows="3" placeholder="Any additional details (optional)"></textarea>
    </div>
    <!-- Hidden fields for date and time -->
    <input type="hidden" id="id_date" name="date">
    <input type="hidden" id="id_time" name="time">
    <!-- Button triggers the Date/Time Modal -->
    <button type="button" class="btn btn-warning w-100" data-bs-toggle="modal" data-bs-target="#bookingModal">
      Next: Select Date & Time
    </button>
  </form>
</div>

<!-- Booking Modal -->
<div class="modal fade" id="bookingModal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content shadow">
      <div class="modal-header">
        <!-- Week Navigation using Django links -->
        <a href="{% url 'book_facility' %}?week_offset={{ week_offset|add:"-1" }}" class="btn btn-outline-secondary">
          <i class="bi bi-chevron-left"></i>
        </a>
        <h5 class="modal-title text-center flex-grow-1" id="bookingModalLabel">Select a Date</h5>
        <a href="{% url 'book_facility' %}?week_offset={{ week_offset|add:"1" }}" class="btn btn-outline-secondary">
          <i class="bi bi-chevron-right"></i>
        </a>
      </div>
      <div class="modal-body">
        <!-- Days of the Week Row -->
        <div class="d-flex justify-content-around mb-4">
          {% for day in week_days %}
            <button type="button" class="btn {% if day.disabled %}btn-secondary disabled{% else %}btn-outline-light{% endif %} shadow text-dark" 
                    name="selected_day" value="{{ day.date }}">
              {{ day.formatted }}
            </button>
          {% endfor %}
        </div>
        <!-- Available Time Slots (using radio buttons) -->
        <div class="d-flex flex-wrap justify-content-center gap-3">
          {% for hour in "09 10 11 12 13 14 15 16 17".split %}
            <label class="btn btn-warning shadow text-dark">
              <input type="radio" name="time_slot" value="{{ hour }}:00" autocomplete="off"> {{ hour }}:00
            </label>
          {% endfor %}
        </div>
      </div>
      <div class="modal-footer">
        <!-- Confirm Booking Button: When clicked, the form is submitted -->
        <button type="submit" form="bookingForm" class="btn btn-primary">Confirm Booking</button>
      </div>
    </div>
  </div>
</div>
{% endblock %}


{% endblock %}
